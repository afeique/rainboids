<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Rainboids: Supercharged Asteroids</title>
    <script src="https://sfxr.me/riffwave.js"></script>
    <script src="https://sfxr.me/sfxr.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="loading-screen">
        <h1>RAINBOIDS</h1>
        <div id="loading-container">
            <div id="loading-bar">
                <div id="loading-progress"></div>
            </div>
            <p id="loading-text">Loading...</p>
        </div>
    </div>
    
    <div id="scanline-overlay"></div>
    <div id="title-screen">
        <h1 id="game-title"></h1>
        <p id="high-score-display"></p>
        <p id="start-prompt">Press Any Key To Start</p>
    </div>
    
    <div id="orientation-overlay">
        <div class="rotate-icon">üì±</div>
        <p>For the best experience,<br>please rotate your device to landscape mode.</p>
    </div>

    <div id="energy-bar-row">
        <span id="energy-value"></span>
        <div id="energy-bar-container">
            <div id="energy-bar"></div>
        </div>
    </div>
    <div id="energy-tanks"></div>
    <div id="music-info" class="ui-element">
        <div id="track-name" class="marquee">
            <span id="track-name-text"></span>
        </div>
        <div id="music-info-progress-container">
            <span id="music-info-current-time">0:00</span>
            <div id="music-progress-bar">
                <div id="music-progress"></div>
            </div>
            <span id="music-info-duration">0:00</span>
        </div>
    </div>
    <div id="score" class="ui-element">0</div>
    <div id="pause-button" class="ui-element">PAUSE</div>
    
    <div id="game-message-overlay" class="ui-element">
        <h1 id="message-title" class="message-title" style="display: none;"></h1>
        <p id="message-subtitle" class="message-subtitle" style="display: none;"></p>
    </div>

    <div id="pause-overlay" class="ui-element" style="display: none; justify-content: center; align-items: center; width: 100%; height: 100%;">
        <div id="pause-menu">
            <div class="pause-tabs">
                <button class="pause-tab active" data-tab="controls">CONTROLS</button>
                <button class="pause-tab" data-tab="music">MUSIC</button>
            </div>
            
            <div id="controls-tab" class="pause-tab-content active">
                <h2>CONTROLS</h2>
                <div><span class="control-symbol">ü°Ñü°Ü</span> Rotate</div>
                <div><span class="control-symbol">‚Üë</span> Thrust</div>
                <div><span class="control-symbol">‚Üì</span> Brake</div>
                <div><span class="control-symbol">‚Ñ§</span> &nbsp;Fire</div>
                <div>SPACE Tractor</div>
                <div>ESC Pause/Resume</div>
                <h2>MOBILE</h2>
                <div>Joystick: Rotate</div>
                <div>
                    <span class="control-symbol">‚Üë</span> Thrust
                    <span class="control-symbol">‚åñ</span> Fire
                </div>
                <div style="text-align: center;">
                    <span class="control-symbol">‚äô</span> Tractor
                </div>
            </div>
            
            <div id="music-tab" class="pause-tab-content">
                <h2>NOW PLAYING</h2>
                <div id="music-player">
                    <div id="current-track-name"></div>
                    <div id="music-progress-container">
                        <span id="music-current-time">0:00</span>
                        <div id="music-player-progress-bar">
                            <div id="music-player-progress"></div>
                        </div>
                        <span id="music-duration">0:00</span>
                    </div>
                    <div id="music-controls">
                        <button id="music-shuffle" class="music-control-btn left">üîÄ</button>
                        <div class="music-main-controls">
                            <button id="music-prev" class="music-control-btn">‚èÆ</button>
                            <button id="music-play-pause" class="music-control-btn large">‚ñ∂</button>
                            <button id="music-next" class="music-control-btn">‚è≠</button>
                        </div>
                        <button id="music-repeat" class="music-control-btn right">üîÅ</button>
                    </div>
                    <div id="playlist-container">
                        <h3>PLAYLIST</h3>
                        <div id="playlist-tracks"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="customization-overlay">
        <h2>Control Layout</h2>
        <p>Drag the controls to your desired positions, then press Save.</p>
        <button id="save-layout-button">Save & Close</button>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div id="mobile-pause-button">||</div>

    <div id="mobile-controls">
        <div id="joystick-area" data-control-id="joystick-area">
            <div id="joystick-base">
                <div id="joystick-handle"></div>
            </div>
        </div>
        
        <div id="touch-fire" class="control-button" data-control-id="touch-fire">‚åñ</div>
        <div id="touch-thrust" class="control-button" data-control-id="touch-thrust">‚Üë</div>
        <div id="touch-tractor" class="control-button" data-control-id="touch-tractor">‚äô</div>
    </div>

    <!-- Load the modular JavaScript after external libraries -->
    <script>
        // Wait for external libraries to load before starting the game
        window.addEventListener('load', () => {
            // Ensure sfxr is available globally
            if (typeof sfxr === 'undefined' || typeof RIFFWAVE === 'undefined') {
                console.error('External libraries not loaded properly');
                return;
            }
            
            // Now load the main module
            import('./js/main.js').then(module => {
                console.log('Game module loaded');
            }).catch(err => {
                console.error('Failed to load game module:', err);
            });
        });
    </script>
</body>
</html> 